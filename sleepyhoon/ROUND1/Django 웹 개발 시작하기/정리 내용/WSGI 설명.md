# WSGI?

## 📌 WSGI?

> Web Server Gateway InterFace의 약자로써 파이썬 스크립트(웹 어플리케이션)가 웹 서버와 통신하기 위한 인터페이스입니다.
> 

WSGI는 서버와 앱 양단으로 나뉘어져 있습니다. SWGI 리퀘스트를 처리하려면 서버에서 환경정보와 콜백함수를 앱에 제공해야합니다. 앱은 그 요청을 처리하고 콜백함수를 통해 서버에 응답합니다.

➡ Web Service 를 개발하다 보면 공통적으로 필요한 기능들이 있는데, Authentication, Routing, Session, Cookie, Error Page 보여주기, ... 와 같은 기능들이다.

WSGI Middleware 는 Middleware 라는 이름처럼 Web Application 의 실행 전과 후에 이러한 기능들을 추가해주는 녀석이며, 그 자체로도 WSGI Application 이다.

### 주요기능

1. 환경변수가 바뀌면 타겟 URL에 따라서 리퀘스트의 경로를 지정해줍니다.
2. 같은 프로세스에서 여러 애플리케이션과 프레임워크가 실행됩니다.
3. XSLT 스타일시트를 적용하는 것과 같이 전처리합니다.

![Untitled (13)](https://github.com/sleepyhoon/2023-2-Backend-Study/assets/101882530/e576fd29-4f8a-4d6a-adb9-7238a7a2607c)


1. **동작 순서**
사용자가 앱이나 웹브라우저 환경에서 API 서버에 요청을 하게 됩니다.해당 요청은 가장 먼저 웹서버에 가게 됩니다.
    - 클라이언트 API 호출가장 먼저 웹서버로 접속합니다 (nginx)
    - 소켓을 통해 wsgi까지 도달
    - (wsgi: 장고와 웹서버의 데이터 통신을 교환할 수 있게 도와주는 인터페이스)
    - wsgi에서 django로 전달되어 프로젝트내 파이썬 코드가 실행

2. **web server**
클라이언트 요청을 받아 애플리케이션에 전달하고 응답을 받아 다시 클라이언트에게 전달하는 역할을 합니다.단순히 연결고리 역할, 즉 전달의 기능만 하고 정적 데이터(html, css, image, file)등은 웹서버 자체내에서 바로 응답을 줍니다.이렇게정적파일을 따로 관리하기 위한 용도로 사용하며 이를 통해서버까지 요청과 리소스의 부담을 줄여 조금 더 효율적인 서빙을 할 수 있습니다.SSL로드밸런싱, 캐싱동적 요청을 wsgi 전달정적 파일 제공

3. **wsgi**
Web Server Gateway Interface란 뜻으로웹서버와 웹프레임워크 사이에 통신을 담당합니다.웹서버는 html, js외에 서버쪽 python, java등으로 구성된 프레임워크 언어를 해석할 수 없습니다.이를 해결해주는 것이 wsgi의 역할이고 wsgi는비동기 방식의 콜백함수로 이루어져쓰레드를 생성하지 않고도 여러 요청을 동시에 처리할 수 있습니다.대표적으로 사용하는 것은 uwsgi, gunicorn등이 있습니다.웹서버 요청과 앱의 응답을 번역 및 http 응답으로 변환요청이 들어오면 파이썬 코드 호출

4. **socket**
웹서버와 wsgi 사이에 데이터를 주고받기 위한 인터페이스를 말합니다.웹서버와 wsgi 통신 방법은 크게 통신 방법으로는 http 네트워크 통신과 linux 소켓 방식이 있습니다.http는 클라이언트의 요청이 있을때 해당 데이터를 전송 후 연결을 종료합니다.sockect의 경우는 서버 또는 클라이언트중 하나라도 접속을 끊을때까지 연결이 유지가 되어 있기에실시간으로 데이터 교류가 필요할 때에는 socket방식을 더 많이 사용하게 됩니다.wsgi 통신은 기본적으로 socket 방식을 사용 하는데이는 wsgi가 서버 안쪽에서 웹프레임워크의 중계역할을 하기 때문에 상대적으로 가벼운 socket방식을 사용하게 됩니다.